(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{104:function(t,e,a){},105:function(t,e,a){},226:function(t,e,a){"use strict";a.r(e);var n=a(0),s=a.n(n),r=a(38),o=a.n(r),c=(a(104),a(105),a(39)),i=a(40),u=a(43),p=a(42),d=a(228),l=a(227),h=a(14),j=a(10),m=a(96).create({baseURL:"https://test-alpha.reestrdoma.ru/api/",withCredentials:!0}),b="",g={houseData:{getCompanies:function(){return m.get("reestrdoma/companies/",{headers:{Authorization:"Bearer ".concat(b)}})},getHouse:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1714,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return m.get("reestrdoma/company/houses/".concat(t,"/?page=").concat(e,"&perPage=").concat(a),{headers:{Authorization:"Bearer ".concat(b)}})}},auth:{logIn:function(t,e){return m.post("login/",{username:"".concat(t),password:"".concat(e)}).then((function(t){return b=t.data.data.token.access}))}}};window.Api=g,window.token=b;var O=a(64),f="SET_COMPANIES_DATA",C="SET_SELECTED_COMPANY_ID",x="SET_HOUSE_DATA",P="SET_CURRENT_PAGE",y={companiesData:[],houseData:[],currentCompanyId:"",nextPage:0,currentPage:0,lastPage:0,prevPage:0},v=function(t,e,a,n,s){return{type:x,houseData:t,nextPage:n,currentPage:e,lastPage:a,prevPage:s}},A=function(t){return{type:C,currentCompanyId:t}};window.CompaniesDefaulState=y;var _="SET_AUTH_USER_DATA",D={isAuth:!1};window.authDefaulState=D;var I=a(44),S=a.n(I),w=a(2),N=function(t){Object(u.a)(a,t);var e=Object(p.a)(a);function a(){var t;Object(c.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))).onSubmit=function(e){t.props.logIn(e.email,e.password)},t}return Object(i.a)(a,[{key:"render",value:function(){return this.props.isAuth?"":Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{children:"Log in"}),Object(w.jsx)(F,{onSubmit:this.onSubmit})]})}}]),a}(s.a.Component),F=Object(l.a)({form:"authForm"})((function(t){return Object(w.jsxs)("form",{onSubmit:t.handleSubmit,children:[Object(w.jsx)("div",{children:Object(w.jsx)(d.a,{type:"text",name:"email",component:"input",className:S.a.input})}),Object(w.jsx)("div",{children:Object(w.jsx)(d.a,{type:"text",name:"password",component:"input",className:S.a.input})}),Object(w.jsx)("button",{className:S.a.loginBtn,children:"Log in"})]})})),k=Object(h.b)((function(t){return{isAuth:t.Auth.isAuth}}),{logIn:function(t,e){return function(a){g.auth.logIn(t,e).then((function(t){a({type:_,userAuthdata:{isAuth:!0}}),g.houseData.getCompanies().then((function(t){var e;a((e=t.data.data,{type:f,companiesData:e})),a(A(t.data.data[0].id))}))}))}}})(N),E=a(8),T=a.n(E),H=function(t){Object(u.a)(a,t);var e=Object(p.a)(a);function a(){var t;Object(c.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(t=e.call.apply(e,[this].concat(s))).state={companiesField:t.props.companiesData.map((function(t){return Object(w.jsx)("option",{id:t.id,children:t.name})})),houseField:t.props.isAuth?t.props.houseData.map((function(t){return Object(w.jsx)("div",{children:t.address})})):"\u0412\u043e\u0439\u0434\u0438\u0442\u0435 \u0432 \u0443\u0447\u0435\u0442\u043d\u0443\u044e \u0437\u0430\u043f\u0438\u0441\u044c \u0434\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445",currentCompanyId:t.props.currentCompanyId},t}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(t,e,a){e.companiesField.length!=this.props.companiesData.length&&t.currentCompanyId!=this.props.currentCompanyId||e.houseField.length!=this.props.houseData.length||t.currentCompanyId!=this.props.currentCompanyId?(this.props.currentPage?this.props.setHouseData(this.props.currentCompanyId,this.props.currentPage):this.props.setHouseData(this.props.currentCompanyId),this.setState({companiesField:this.props.companiesData.map((function(t){return Object(w.jsx)("option",{id:t.id,children:t.name})})),currentCompanyId:this.props.currentCompanyId,houseField:this.props.houseData.map((function(t){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:t.id}),Object(w.jsx)("td",{className:T.a.tdAdress,children:t.address}),Object(w.jsx)("td",{children:t.reestrFlatCount}),Object(w.jsxs)("td",{children:[t.createdAt.slice(8,10),".",t.createdAt.slice(5,7),".",t.createdAt.slice(0,4)]})]})}))})):t.currentPage==this.props.currentPage&&t.lastPage==this.props.lastPage||this.setState({houseField:this.props.houseData.map((function(t){return Object(w.jsxs)("tr",{children:[Object(w.jsx)("td",{children:t.id}),Object(w.jsx)("td",{className:T.a.tdAdress,children:t.address}),Object(w.jsx)("td",{children:t.reestrFlatCount}),Object(w.jsxs)("td",{children:[t.createdAt.slice(8,10),".",t.createdAt.slice(5,7),".",t.createdAt.slice(0,4)]})]})}))})}},{key:"render",value:function(){var t=this;return this.props.isAuth?Object(w.jsxs)("div",{className:T.a.page,children:[Object(w.jsx)("select",{className:T.a.CompanySelect,onChange:function(e){console.log(e.target.selectedOptions[0].id),t.props.metaDataHouseToNull(),t.props.setSelectedCompanyId(+e.target.selectedOptions[0].id)},children:this.state.companiesField}),this.state.houseField.length?Object(w.jsxs)("table",{className:T.a.table,children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{children:"Id"}),Object(w.jsx)("th",{children:"\u0410\u0434\u0440\u0435\u0441\u0441"}),Object(w.jsx)("th",{children:"\u041a\u043e\u043b-\u0432\u043b \u043a\u0432\u0430\u0440\u0442\u0438\u0440"}),Object(w.jsx)("th",{children:"\u0414\u0430\u0442\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f"})]}),this.state.houseField]}):Object(w.jsx)("div",{children:"\u0423 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438 \u043d\u0435\u0442 \u0430\u0434\u0440\u0435\u0441\u043e\u0432"}),Object(w.jsxs)("div",{className:T.a.paginatorBox,children:[Object(w.jsx)("button",{className:"".concat(T.a.button," ").concat(T.a.buttonLeft),onClick:function(){t.props.setHouseData(t.props.currentCompanyId,1)},children:"<<"}),Object(w.jsx)("button",{className:"".concat(T.a.button," ").concat(T.a.buttonLeft),onClick:function(){t.props.setHouseData(t.props.currentCompanyId,t.props.prevPage)},children:"<"}),this.props.currentPage,"...",this.props.lastPage,Object(w.jsx)("button",{className:"".concat(T.a.button," ").concat(T.a.buttonRigth),onClick:function(){t.props.setHouseData(t.props.currentCompanyId,t.props.nextPage)},children:">"}),Object(w.jsx)("button",{className:"".concat(T.a.button," ").concat(T.a.buttonRigth),onClick:function(){t.props.setHouseData(t.props.currentCompanyId,t.props.lastPage)},children:">>"})]})]}):""}}]),a}(s.a.Component),L=Object(h.b)((function(t){return{isAuth:t.Auth.isAuth,companiesData:t.Companies.companiesData,houseData:t.Companies.houseData,currentCompanyId:t.Companies.currentCompanyId,prevPage:t.Companies.prevPage,currentPage:t.Companies.currentPage,nextPage:t.Companies.nextPage,lastPage:t.Companies.lastPage}}),{setSelectedCompanyId:A,setHouseData:function(t,e){return function(a){g.houseData.getHouse(t,e).then((function(t){a(v(t.data.data,t.data.links.currentPage,t.data.links.lastPage,t.data.links.nextPage,t.data.links.prevPage))}))}},metaDataHouseToNull:function(){return function(t){t(v([],null,null,null,null))}}})(H);window.state=H.state;var B=function(){return Object(w.jsxs)("div",{className:"App",children:[Object(w.jsx)(k,{}),Object(w.jsx)(L,{})]})},R=function(t){t&&t instanceof Function&&a.e(3).then(a.bind(null,230)).then((function(e){var a=e.getCLS,n=e.getFID,s=e.getFCP,r=e.getLCP,o=e.getTTFB;a(t),n(t),s(t),r(t),o(t)}))},U=a(6),z=a(98),J=a(229),M=Object(U.c)({Companies:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case f:return Object(j.a)(Object(j.a)({},t),{},{companiesData:Object(O.a)(e.companiesData)});case x:return Object(j.a)(Object(j.a)({},t),{},{houseData:Object(O.a)(e.houseData),nextPage:e.nextPage,currentPage:e.currentPage,lastPage:e.lastPage,prevPage:e.prevPage});case C:return Object(j.a)(Object(j.a)({},t),{},{currentCompanyId:e.currentCompanyId});case P:return Object(j.a)(Object(j.a)({},t),{},{currentPage:e.currentPage});default:return t}},Auth:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case _:return Object(j.a)(Object(j.a)({},t),e.userAuthdata);default:return t}},form:J.a}),X=Object(U.d)(M,Object(U.a)(z.a));window.store=X;var Y=X;o.a.render(Object(w.jsx)(s.a.StrictMode,{children:Object(w.jsx)(h.a,{store:Y,children:Object(w.jsx)(B,{})})}),document.getElementById("root")),R()},44:function(t,e,a){t.exports={input:"Auth_input__SyBrL",loginBtn:"Auth_loginBtn__2SRXu"}},8:function(t,e,a){t.exports={page:"Companies_page__3EyJL",CompanySelect:"Companies_CompanySelect__2jszs",paginatorBox:"Companies_paginatorBox__3Xeg1",table:"Companies_table__1eYv-",tdAdress:"Companies_tdAdress__4dacm",button:"Companies_button__19Xsf",buttonRigth:"Companies_buttonRigth__lWISp",buttonLeft:"Companies_buttonLeft__2DY7s"}}},[[226,1,2]]]);
//# sourceMappingURL=main.06f239f0.chunk.js.map